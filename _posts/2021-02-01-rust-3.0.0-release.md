---
layout: post
title: "Apache Arrow 3.0.0 Rust Highlights"
date: "2021-02-01 00:00:00 -0600"
author: pmc
categories: [release]
---
<!--
{% comment %}
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to you under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
{% endcomment %}
-->

We are excited to announce the general availability of the Rust implementation of Apache Arrow 3.0.0,  now available 
on crates.io. This release has more than 300 issues resolved. This blog post provides an overview 
of the most significant changes in this release.

The full list of resolved issues can be found [here][1].

# Core Arrow Crate

The development of the arrow crate was focused on four main aspects:

- Make the crate usable in stable Rust
- Bug fixing and removal of `unsafe` code
- Extend functionality to keep up with the specification
- Increase performance of existing kernels

## Stable Rust

Possibly the biggest news for this release is that all project crates, including arrow, parquet, and datafusion now 
build with stable Rust by default. Nightly / unstable Rust is still required when enabling the SIMD feature.

## Parquet Arrow writer

The Parquet Writer for Arrow arrays is now available, allowing the Rust programs to easily read and write Parquet 
files and making it easier to integrate with the overall Arrow ecosystem. The reader and writer include both basic 
and nested type support (List, Dictionary, Struct)

## First Class Arrow Flight IPC Support

This release the Arrow Flight IPC implementation in Rust became fully-featured enough to participate in the regular 
cross-language integration tests, thus ensuring Rust applications written using Arrow can interoperate with the rest 
of the ecosystem

## Performance

There have been numerous performance improvements in this release across the board. This includes both kernel 
operations, such as `take`, `filter`, and `cast`, as well as more fundamental parts such as bitwise comparison 
and reading and writing to CSV.

## Increased Data Type Support

New DataTypes:
- Decimal data type for fixed-width decimal values

Improved operation support for nested structures Dictionary, and Lists (filter, take, etc)

## Other improvements:

- Added support for Date and time on FFI
- Added support for Binary type on FFI
- Added support for i64 sized arrays to “take” kernel
- Support for the i128 Decimal Type
- Added support to cast string to date
- Added API to create arrays out of existing arrays (e.g. for join, merge-sort, concatenate)
- The simd feature is now also available on aarch64

## API Changes

- BooleanArray is no longer a PrimitiveArray
- ArrowNativeType no longer includes bool since arrows boolean type is represented using bitpacking
- Several Buffer methods are now infallible instead of returning a Result
- DataType::List now contains a Field to track metadata about the contained elements
- PrimitiveArray::raw_values, values_slice and values methods got replaced by a values method returning a slice
- Buffer::data and raw_data were renamed to as_slice and as_ptr
- MutableBuffer::data_mut and freeze were renamed to as_slice_mut and into to be more consistent with the stdlib naming conventions
- The generic type parameter for BufferBuilder was changed from ArrowPrimitiveType to ArrowNativeType

# DataFusion

## SQL

In this release, we clarified that DataFusion will standardize on the PostgreSQL SQL dialect.

New SQL support:
- JOIN, LEFT JOIN, RIGHT JOIN
- COUNT DISTINCT
- CASE WHEN
- USING
- BETWEEN
- IS IN
- Nested SELECT statements
- Nested expressions in aggregations
- LOWER(), UPPER(), TRIM()
- NULLIF()
- SHA224(), SHA256(), SHA384(), SHA512()
- DATE_TRUNC()

## Performance

There have been numerous performance improvements in this release:
- Optimizations for JOINs such as using vectorized hashing.
- We started with adding statistics and cost-based optimizations. We choose the smaller side of a join as the build
  side if possible.
- Improved parallelism when reading partitioned Parquet data sources
- Concurrent writes of CSV and Parquet partitions to file

# Parquet Crate

The Parquet has the following improvements:

- Nested reading
- Support to write booleans
- Add support to write temporal types

# Roadmap for 4.0.0

We have also started building up a shared community roadmap for 4.0: [Apache Arrow: Crowd Sourced Rust Roadmap for 
Arrow 4.0, January 2021][2].

How to Get Involved

If you are interested in contributing to the Rust subproject in Apache Arrow you can find a list of open issues 
suitable for beginners here and the full list here. In addition, try checking out the road map for areas others 
are working on and consider assisting in those endeavors, either in documentation, testing, or code!

Other ways to get involved include trying out Arrow on some of your own data and filing bug reports and helping 
to improve the documentation.

[1]: https://issues.apache.org/jira/browse/ARROW-11329?jql=project%20%3D%20ARROW%20AND%20status%20not%20in%20%20(Open%2C%20%22In%20Progress%22%2C%20Reopened)%20and%20fixVersion%20%3D%203.0.0%20AND%20text%20~%20rust%20ORDER%20BY%20created%20DESC
[2]: https://docs.google.com/document/d/1qspsOM_dknOxJKdGvKbC1aoVoO0M3i6x1CIo58mmN2Y/edit#heading=h.kstb571j5g5j